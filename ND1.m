clear all
close all;

%training data
%good connectivity examples
a = [13.2251282554863 -7.82952358013424 0.607610748903317 13.6494572393845 -8.95540548424849 12.6009217681733 -17.6693208904718 -2.28844471097173 14.2819992627737 5.50636302940108 -0.0520087345918974 2.57769108646557 -9.06448070870084 -14.9665016788253 -20.8678260394508 6.05136571944538 -19.2129750382367 3.94328665991215 -18.1099116846338 5.02565704269541 2.75126279845424 1.65866221710598 -3.81381824084850 12.5642763993948 8.43881275602728 -12.3589732903810 -5.21026109887456 4.15185388007627 -3.79146430550706 10.7465832935436 -12.5926384643998 5.24502931322847 7.24489315336337 3.45235292046304 2.47244221887584 -13.5668971142120 16.6391271165901 -1.39978294823130 -12.6615209584697 -9.89694170784376 -14.4571221342613 -9.34841196938327 6.11140822983546 -3.30262478509899 1.90534702197106 8.08242234192887 -6.67199122668384 7.57302345569743 -1.85804983382758 -2.96453687870504 -22.021639550539700 -12.656286875166600 -17.046521929703600 -12.018541962691300 -10.875333519262400 -1.742056180186940 9.791342640990170 13.800565263438800 9.997597930751790];
b = [3.30223310529171 -1.73929740789854 -5.78969639877976 17.0021208670549 0.484537231762492 0.217692522318746 -4.04052971097148 -14.6924374645131 12.5158958440742 -9.62664247605669 1.13565266982562 0.565248024753894 11.4785617682984 -2.53075990104800 -8.18370562401541 -5.65512385426876 1.37188616886860 -1.90661776394295 -14.7157340985996 10.3394832170821 -4.78966147019005 25.2219346202347 -0.149444865610212 -2.54448988868473 0.856989769553652 2.21273956668052 5.47586988525954 26.2685592267252 -19.4297831928818 -10.1226031633861 -6.84035715393763 3.07997874544183 -3.75650203950185 5.62416535537842 -13.9043735807912 11.5489052046223 2.64918739532981 3.29842329114951 -12.2996899926530 -5.95416872927518 1.64204611220001 -7.65478299118492 8.15680225595676 -6.35371363847256 -7.88646378653007 4.67235949842144 -8.95655120528461 9.69757448581258 -15.1383878366301 -7.32659090495896 8.097458515129350 14.420490485184300 -0.638002202801615 -11.139100396775700 -26.388848040809300 8.752915095058970 13.207145289432800 10.591578339014300 -6.324261055260570];
%bad connectivity examples
c = [91.5477538530113 -38.2188995283533 31 12.5012246306298 36.0259530102155 131.785566733727 62.9883077450063 -22.8149516409545 29.8958856158272 63.9618187944720 -2.21657844601440 -109.260745128883 0 -58.4586828155696 26.3130113659371 -4.87853278847106 47.2053790940538 -45.6613776760030 51.9058686140231 -52.2980066135631 68.0848082791885 8.08503857667261 53.6904868352119 -64.2264053593424 38.8559105505671 -26.7420168109960 -69.2399494548719 56.7889434883708 18.4859686668344 -7.10988487380542 10.2686448911895 -21.7867104550903 -61.2726682709334 -95.0346522635293 -77.2353542688481 -21.1275884267705 30.2457950349210 -4.72384593084055 6.04395550923251 -20.4544418490674 14.0702093156882 36.6375592997801 -33.5342192263691 -57.0339822875254 24.4627822038298 -28.9897312272334 -99.6438707902242 11.0890214708105 26.9137018549362 31.6446930771758];
t = [16.6827813664678 -3.56885253960042 5.55248883285930 87.0923816400731 2.08189280412613 -15.8192991391601 62.6326719065958 52.0738197304460 76.8638927334021 43.4438566172988 31.3788020000000 62.5585389309892 -32.5000000000000 -13.0789380738037 -36.2522595303888 78.0394447955979 105.683593145111 45.7762603867715 -26.5316956775625 -54.1415867209510 -40.5797194808894 32.5785922842821 -57.8839474950715 -69.7940194895403 -67.8404070779242 20.2412050159151 -91.7993459998116 22.1365988483077 26.0446604334356 -47.5177022715857 -42.5702885465794 -26.0498701904483 -28.6952199708368 38.1147924790148 -6.45632161015244 -38.3190036580709 22.6944821666346 44.1049956282197 -77.6606677354659 54.1780310100118 -46.3402879081420 -87.5174717022761 3.36824904297388 50.8922124325490 55.0749330245113 -17.6912177599459 31.0335164567939 -29.5812132200806 -17.6380003015598 51.7706782725809];
%desired response
d = [ones(1,59), zeros(1,50)];

x1 = [a, c];%x
x2 = [b, t];%y

index1 = 1;
index2 = 1;

%mobile base station (MBS)
x_station = 0; %MBS station located at (0,0)
y_station = 0; 
r = 30;%MBS radius = 30km
th = 0:pi/50:2*pi;
x_station_radius = r * cos(th) + x_station;
y_station_radius = r * sin(th) + y_station;
figure('Name','Devices near the mobile base learning data set');
plot(x_station,y_station,'bd',x_station_radius,y_station_radius,'b.');
grid on;
hold on;
scatter(x1,x2,'m*');
legend('MBS','MBS connectivity zone','Devices');
xlabel('km'); 
ylabel('km');
hold off;

%learning rate
m = 0.15;
%choose weights, centers, radius
w0 = rand(1);
w1 = rand(1);
w2 = rand(1);
c1_x = x_station;
c1_y = y_station;
r1 = r;


    for epoch = 1:10000
        for n = 1:length(x1)
            %radial basis f(x) response, using Gauss f(x)
            F = exp(-( ((x1(n)-c1_x)^2 + (x2(n)-c1_y)^2)/(2*r1^2) ));
            %net response 
            v = F*w1 +F*w2 + w0; 
                if v > 0
                    y = 0;
                else
                    y = 1;
                end
            %error calculation
            e = d(n) - y;
            %weight update
            w1 = w1 + m*e*x1(n);
            w2 = w2 + m*e*x2(n);
            w0 = w0 + m*e;
        end   
    end


figure('Name','Devices near the mobile base station sorting result for learning data set');
plot(x_station,y_station,'bd',x_station_radius,y_station_radius,'b.');
hold on;
grid on;
        for n = 1:length(x1)
            %radial basis f(x) response, using Gauss f(x)
            F = exp(-( ((x1(n)-c1_x)^2 + (x2(n)-c1_y)^2)/(2*r1^2) ));
  
            %net response 
            v = F*w1 +F*w2 + w0;  
                if v > 0
                   %plot(x1(n),x2(n),'r+');
                   red_x(index1) = x1(n);
                   red_y(index1) = x2(n);
                   index1 = index1 + 1;
                else
                   % plot(x1(n),x2(n),'go');            
                   green_x(index2) = x1(n);
                   green_y(index2) = x2(n);
                   index2 = index2 + 1;
                end
        end 
plot(red_x,red_y,'r+',green_x,green_y,'go');
legend('MBS','MBS connectivity zone','Connectivity not covered', 'Connectivity covered');
xlabel('km'); 
ylabel('km');
hold off;



%new data st 1, not for learning--------------------------------------------------------------------------------
a = [-50.0796227992317 -27.7830723567321 -67.5778171260998 18.2105661367404 -22.6103802489265 39.1682984943030 61.8618323939878 53.8599090716729 -1.74205618018694 -25.1993666981349 -61.2009487404394 5.92545413937491 47.9736750367687 -17.0465219297036 -8.66591654920786 30.8150253837420 43.1959684793848 -70.8457083488126 9.99759793075179 9.79134264099017 -7.55662014690922 44.6392081517209 -18.2095094041813 -41.3094344280180 13.8005652634388 22.9898650486341 -10.8753335192624 39.8061483715702 -75.9011283942904 -53.7458516192978 -153.608286698601 26.0703594312859 -49.5511813237778 -12.6562868751666 50.4632631179482 2.55060265486053 -22.0216395505397 -42.4234705652168 -12.0185419626913 30.1464718080767 -75.8126825513172 -3.41742511407132 39.1196432604867 -71.0362961537425 33.4682565411512 34.1618318862209 -44.1068111613471 -75.2254377739953 21.6569699422982 40.4127856718757];
b = [28.9468992910962 38.1424562903591 -59.1063516972698 29.1923845052107 -29.0004840941984 -28.0683594596173 -77.7948240929390 55.0104228147614 8.75291509505897 50.1805655166536 75.5504087139483 -56.8619515157887 32.1509196580686 -0.638002202801615 45.7129862504685 55.3847288017014 41.0235730733145 -40.8805916127473 -6.32426105526057 13.2071452894328 157.926403646518 61.3308614255853 116.031766067674 20.7248930319509 10.5915783390143 30.6583445851253 -26.3888480408093 62.0800625676264 -7.88153414062617 -68.6800892296801 43.5419077358954 -78.4266651070592 -92.2126447957780 14.4204904851843 -47.5455563756602 -45.5366047033994 -8.09745851512935 -24.4450882859472 -11.1391003967757 13.6033248219027 -58.4265446915221 -61.2117153464612 -104.973934981283 -19.5121315029769 33.2140878879517 -35.1132003590089 25.0663767154235 27.0156872848872 49.5375493265987 49.4689058350994];
x1 = a;%x
x2 = b;%y
index1 = 1;
index2 = 1;

%mobile base station (MBS)
figure('Name','Devices near the mobile base data set 1');
plot(x_station,y_station,'bd',x_station_radius,y_station_radius,'b.');
grid on;
hold on;
scatter(x1,x2,'m*');
legend('MBS','MBS connectivity zone','Devices');
xlabel('km'); 
ylabel('km');
hold off;

figure('Name','Devices near the mobile base station sorting result for data set 1');
plot(x_station,y_station,'bd',x_station_radius,y_station_radius,'b.');
hold on;
grid on;
        for n = 1:length(x1)
            %net response 
             F = exp(-( ((x1(n)-c1_x)^2 + (x2(n)-c1_y)^2)/(2*r1^2) ));
             v = F*w1 +F*w2 + w0;  
                if v > 0
                   %plot(x1(n),x2(n),'r+');
                   red_x(index1) = x1(n);
                   red_y(index1) = x2(n);
                   index1 = index1 + 1;
                else
                   % plot(x1(n),x2(n),'go');            
                   green_x(index2) = x1(n);
                   green_y(index2) = x2(n);
                   index2 = index2 + 1;
                end
        end 
plot(red_x,red_y,'r+',green_x,green_y,'go');
legend('MBS','MBS connectivity zone','Connectivity not covered', 'Connectivity covered');
xlabel('km'); 
ylabel('km');
hold off;




%new data st 2, not for learning--------------------------------------------------------------------------------
a = randn(50,1)*29;
b = randn(50,1)*29;
x1 = a;%x
x2 = b;%y
index1 = 1;
index2 = 1;

%mobile base station (MBS)
figure('Name','Devices near the mobile base data set 2');
plot(x_station,y_station,'bd',x_station_radius,y_station_radius,'b.');
grid on;
hold on;
scatter(x1,x2,'m*');
legend('MBS','MBS connectivity zone','Devices');
xlabel('km'); 
ylabel('km');
hold off;

figure('Name','Devices near the mobile base station sorting result for data set 2');
plot(x_station,y_station,'bd',x_station_radius,y_station_radius,'b.');
hold on;
grid on;
        for n = 1:length(x1)
            %net response 
             F = exp(-( ((x1(n)-c1_x)^2 + (x2(n)-c1_y)^2)/(2*r1^2) ));
             v = F*w1 +F*w2 + w0;  
                if v > 0
                   %plot(x1(n),x2(n),'r+');
                   red_x(index1) = x1(n);
                   red_y(index1) = x2(n);
                   index1 = index1 + 1;
                else
                   % plot(x1(n),x2(n),'go');            
                   green_x(index2) = x1(n);
                   green_y(index2) = x2(n);
                   index2 = index2 + 1;
                end
        end 
plot(red_x,red_y,'r+',green_x,green_y,'go');
legend('MBS','MBS connectivity zone','Connectivity not covered', 'Connectivity covered');
xlabel('km'); 
ylabel('km');
hold off;
